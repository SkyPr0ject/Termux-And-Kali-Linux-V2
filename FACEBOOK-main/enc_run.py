import base64 
exec(base64.b64decode("IyEvdXNyL2Jpbi9weXRob24zCiMtKi1jb2Rpbmc6dXRmLTgtKi0KCmltcG9ydCBzeXMsb3MscmVxdWVzdHMsanNvbix0aW1lCmZyb20gY29uY3VycmVudC5mdXR1cmVzIGltcG9ydCBUaHJlYWRQb29sRXhlY3V0b3IgYXMgVGhyZWFkUG9vbApmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRldGltZQoKc2FhdF9pbmkgPSBkYXRldGltZS5ub3coKQp0Z2wgPSBzYWF0X2luaS5zdHJmdGltZSgnJWQnKQpibG4gPSBzYWF0X2luaS5zdHJmdGltZSgnJW0nKQp0aG4gPSBzYWF0X2luaS5zdHJmdGltZSgnJVknKQp3YWt0dV9uZXcgPSAodGdsKyItIitibG4rIi0iK3RobikKeG54eD0iXDAzM1s4NW0iCnE9IlwwMzNbMDBtIgpoMj0iXDAzM1s0MG0iCmIyPSJcMDMzWzQ0bSIKYzI9IlwwMzNbNDZtIgppMj0iXDAzM1s0Mm0iCnUyPSJcMDMzWzQ1bSIKbTI9IlwwMzNbNDFtIgpwMj0iXDAzM1s0N20iCmsyPSJcMDMzWzQzbSIKYj0nXDAzM1sxOzM0bScKaT0nXDAzM1sxOzMybScKYz0nXDAzM1sxOzM2bScKbT0nXDAzM1sxOzMxbScKdT0nXDAzM1sxOzM1bScKaz0nXDAzM1sxOzMzbScKcD0nXDAzM1sxOzM3bScKaD0nXDAzM1sxOzkwbScKazM9IlwwMzNbNDNtXDAzM1sxOzM3bSIKYjM9IlwwMzNbNDRtXDAzM1sxOzM3bSIKbTM9IlwwMzNbNDFtXDAzM1sxOzM3bSIKCmRlZiBiYW5uZXIoKToKICAgIHByaW50KG0gKyIiIgogICAgICAgX18gIF9fIF9fX18gICAgXyBfX19fIF9fX18gX19fX18KICAgICAgfCAgXC8gIHwgIF8gXCAgLyB8IF9fX3wgX19ffF9fXyAgfAogICAgICB8IHxcL3wgfCB8XykgfCB8IHxfX18gXF9fXyBcICAvIC8KICAiIiIrIHAgKyIiIiAgICB8IHwgIHwgfCAgXyA8IF98IHxfX18pIHxfXykgfC8gLwogICAgICB8X3wgIHxffF98IFxfKF8pX3xfX19fL19fX18vL18vCiAgX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18iIiIpCgpkZWYgamFsYW4oeik6Cglmb3IgZSBpbiB6ICsgIlxuIjoKCQlzeXMuc3Rkb3V0LndyaXRlKGUpCgkJc3lzLnN0ZG91dC5mbHVzaCgpCgkJdGltZS5zbGVlcCgwLjA1KQoKZGVmIGxvZ2luKCk6CiAgICBvcy5zeXN0ZW0oInJtIC1yZiBsb2dpbi50eHQiKQogICAgb3Muc3lzdGVtKCdjbGVhcicpCiAgICB1cmwgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vYXBpLm15aXAuY29tIikudGV4dAogICAganMxID0ganNvbi5sb2Fkcyh1cmwpCiAgICBiYW5uZXIoKQogICAgcHJpbnQgKCcgIElwIEthbXUgOiB7fScuZm9ybWF0KGpzMVsiaXAiXSkpCiAgICB0b2tldCA9IGlucHV0KCIgIFvigKJdIFRva2VuIDogIikKICAgIHRyeToKICAgICAgICBvdHcgPSByZXF1ZXN0cy5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2FjY2Vzc190b2tlbj0nICsgdG9rZXQpCiAgICAgICAgYSA9IGpzb24ubG9hZHMob3R3LnRleHQpCiAgICAgICAgbmFtYSA9IGFbJ25hbWUnXQogICAgICAgIHhkID0gb3BlbignbG9naW4udHh0JywgJ3cnKQogICAgICAgIHhkLndyaXRlKHRva2V0KQogICAgICAgIHhkLmNsb3NlKCkKICAgICAgICBwcmludCgnXG5b4oCiXSBMb2dpbiBTdWNjZXNzZnVsJykKICAgICAgICBtZW51KCkKICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICBwcmludCAoIlxuWyFdIFRva2VuIEludmFsaWQiKQogICAgICAgIG9zLnN5c3RlbSgnY2xlYXInKQogICAgICAgIGxvZ2luKCkKCmRlZiBtZW51KCk6CiAgICB0cnk6CiAgICAgICAgdG9rZXQgPSBvcGVuKCJsb2dpbi50eHQiLCJyIikucmVhZCgpCiAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgamFsYW4oIlxuWyFdIFRva2VuIEludmFsaWQiKQogICAgICAgIGxvZ2luKCkKICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgIGphbGFuKCJcblshXSBUb2tlbiBJbnZhbGlkIikKICAgICAgICBsb2dpbigpCiAgICBvcy5zeXN0ZW0oJ2NsZWFyJykKICAgIHVybCA9IHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9hcGkubXlpcC5jb20iKS50ZXh0CiAgICBqcyA9IGpzb24ubG9hZHModXJsKQogICAgcHJpbnQgKG0gKycgICAgX18gIF9fX19fX18gIF9fX19fXycpCiAgICBwcmludCAoJyAgIC8gIHwvICAvIF9fICkvIF9fX18vIHwgQXV0aG9yIDogQWxkaSBiYWNodGlhciByaWZhaScpCiAgICBwcmludCAoJyAgLyAvfF8vIC8gX18gIC8gL18gICAgIHwgWVQgICAgIDogTVIuMTU1NycpCiAgICBwcmludCAocCArJyAvIC8gIC8gLyAvXy8gLyBfXy8gICAgIHwgSWcgICAgIDogQEFsZGkucmlmYWkuMTInKQogICAgcHJpbnQgKCcvXy8gIC9fL19fX19fL18vICAgICAgICB8IHNjICAgICA6IFZlcnNpIDEnKQogICAgcHJpbnQgKHAgKydfX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXycpCiAgICBwcmludCAoJ0lwIEthbXUgOiB7fScuZm9ybWF0KGpzWyJpcCJdKSkKICAgIHByaW50ICgnRGF0ZSAgICA6ICcrIHdha3R1X25ldykKICAgIHByaW50ICgnX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18nKQogICAgcHJpbnQoIlsxXSBHZXQgSUQgRnJvbSBGcmllbmRsaXN0IikKICAgIHByaW50KCJbMl0gR2V0IElEIEZyb20gUHVibGljIikKICAgIHByaW50KCJbM10gR2V0IElEIEZyb20gRm9sbG93ZXJzIikKICAgIHByaW50KCJbMF0gTG9nIE91dCIpCiAgICBtbiA9IGlucHV0KCJcblvigKJdIFNlbGVjdCA6ICIpCiAgICBpZiBtbiBpbiBbIiJdOgogICAgICAgIGphbGFuKCJcblshXSBGaWxsIEluIFRoZSBDb3JyZWN0IikKICAgICAgICBtZW51KCkKICAgIGVsaWYgbW4gaW4gWyIxIiwiMDEiXToKICAgICAgICB0ZW1hbigpCiAgICBlbGlmIG1uIGluIFsiMiIsIjAyIl06CiAgICAgICAgcHVibGljKCkKICAgIGVsaWYgbW4gaW4gWyIzIiwiMDMiXToKICAgICAgICBmb2xsb3dlcnMoKQogICAgZWxpZiBtbiBpbiBbIjAiLCIwMCJdOgogICAgICAgIG9zLnN5c3RlbSgicm0gLXJmIGxvZ2luLnR4dCIpCiAgICAgICAgamFsYW4oIlxuWyFdIFRoYW5rcyBGb3IgVXNpbmcgTXkgU2NyaXB0IikKICAgICAgICBleGl0KCkKICAgIGVsc2U6CiAgICAgICAgamFsYW4oIlxuWyFdIEZpbGwgSW4gVGhlIENvcnJlY3QiKQogICAgICAgIG1lbnUoKQoKZGVmIHRlbWFuKCk6CiAgICB0cnk6CiAgICAgICAgdG9rZXQgPSBvcGVuKCJsb2dpbi50eHQiLCJyIikucmVhZCgpCiAgICAgICAgb3R3ID0gcmVxdWVzdHMuZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9hY2Nlc3NfdG9rZW49JyArIHRva2V0KQogICAgICAgIGEgPSBqc29uLmxvYWRzKG90dy50ZXh0KQogICAgICAgIHByaW50ICgiXG5b4oCiXSBOYW1lIDogJXMiJShhWyduYW1lJ10pKQogICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgIGphbGFuKCJcblshXSBUb2tlbiBJbnZhbGlkIikKICAgICAgICBsb2dpbigpCiAgICBleGNlcHQgSU9FcnJvcjoKICAgICAgICBqYWxhbigiXG5bIV0gVG9rZW4gSW52YWxpZCIpCiAgICAgICAgbG9naW4oKQogICAgdGFtcHVuZz1bXQogICAgdGVtYW49W10KICAgIGxpbSA9IGlucHV0KCJb4oCiXSBMaW1pdCBEdW1wIDogIikKICAgIHByaW50ICgiXG4iKQogICAgYWRhID0gcmVxdWVzdHMuZ2V0KCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZS9mcmllbmRzP2xpbWl0PSVzJmFjY2Vzc190b2tlbj0lcyclKGxpbSx0b2tldCkpCiAgICBpZGkgPSBqc29uLmxvYWRzKGFkYS50ZXh0KQogICAgZm9yIHggaW4gaWRpWydkYXRhJ106CiAgICAgICAgdGFtcHVuZy5hcHBlbmQoeFsnaWQnXSkKICAgIGZvciBpZCBpbiB0YW1wdW5nOgogICAgICAgIHRyeToKICAgICAgICAgICAgYWRhMiA9IHJlcXVlc3RzLmdldCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvZnJpZW5kcz9hY2Nlc3NfdG9rZW49JXMnJShpZCx0b2tldCkpCiAgICAgICAgICAgIGlkaTIgPSBqc29uLmxvYWRzKGFkYTIudGV4dCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZm9yIGIgaW4gaWRpMlsnZGF0YSddOgogICAgICAgICAgICAgICAgICAgIHRlbWFuLmFwcGVuZChiWydpZCddKQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIAlwcmludCgiWyFdIFByaXZhdGUiKQogICAgICAgICAgICBwcmludCgiW+KAol0iLCBpZCwi4oCiIixsZW4odGVtYW4pKQogICAgICAgICAgICB0ZW1hbi5jbGVhcigpCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBwcmludCgiWyFdIEFrdW4gVGVya2VuYSBTcGFtIikKICAgIGtlbWJhbGkoKQoKZGVmIHB1YmxpYygpOgogICAgaXQgPSBpbnB1dCgiXG5b4oCiXSBJRCBQdWJsaWMgOiAiKQogICAgdHJ5OgogICAgICAgIHRva2V0ID0gb3BlbigibG9naW4udHh0IiwiciIpLnJlYWQoKQogICAgICAgIG90dyA9IHJlcXVlc3RzLmdldCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXM/YWNjZXNzX3Rva2VuPSVzJyUoaXQsdG9rZXQpKQogICAgICAgIGEgPSBqc29uLmxvYWRzKG90dy50ZXh0KQogICAgICAgIHByaW50ICgiW+KAol0gTmFtZSA6ICVzIiUoYVsnbmFtZSddKSkKICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICBqYWxhbigiXG5bIV0gVG9rZW4gSW52YWxpZCIpCiAgICAgICAgbG9naW4oKQogICAgZXhjZXB0IElPRXJyb3I6CiAgICAgICAgamFsYW4oIlxuWyFdIFRva2VuIEludmFsaWQiKQogICAgICAgIGxvZ2luKCkKICAgIHRhbXB1bmc9W10KICAgIHRlbWFuPVtdCiAgICBsaW0gPSBpbnB1dCgiW+KAol0gTGltaXQgRHVtcCA6ICIpCiAgICBwcmludCAoIlxuIikKICAgIGFkYSA9IHJlcXVlc3RzLmdldCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvZnJpZW5kcz9saW1pdD0lcyZhY2Nlc3NfdG9rZW49JXMnJShpdCxsaW0sdG9rZXQpKQogICAgaWRpID0ganNvbi5sb2FkcyhhZGEudGV4dCkKICAgIGZvciB4IGluIGlkaVsnZGF0YSddOgogICAgICAgIHRhbXB1bmcuYXBwZW5kKHhbJ2lkJ10pCiAgICBmb3IgaWQgaW4gdGFtcHVuZzoKICAgICAgICB0cnk6CiAgICAgICAgICAgIGFkYTIgPSByZXF1ZXN0cy5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL2ZyaWVuZHM/YWNjZXNzX3Rva2VuPSVzJyUoaWQsdG9rZXQpKQogICAgICAgICAgICBpZGkyID0ganNvbi5sb2FkcyhhZGEyLnRleHQpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGZvciBiIGluIGlkaTJbJ2RhdGEnXToKICAgICAgICAgICAgICAgICAgICB0ZW1hbi5hcHBlbmQoYlsnaWQnXSkKICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAJcHJpbnQoIlshXSBQcml2YXRlIikKICAgICAgICAgICAgcHJpbnQoIlvigKJdIiwgaWQsIuKAoiIsbGVuKHRlbWFuKSkKICAgICAgICAgICAgdGVtYW4uY2xlYXIoKQogICAgICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICAgICAgcHJpbnQoIlshXSBBa3VuIFRlcmtlbmEgU3BhbSIpCiAgICBrZW1iYWxpKCkKCmRlZiBmb2xsb3dlcnMoKToKICAgIGl0ID0gaW5wdXQoIlxuW+KAol0gSUQgRm9sbG93ZXJzIDogIikKICAgIHRyeToKICAgICAgICB0b2tldCA9IG9wZW4oImxvZ2luLnR4dCIsInIiKS5yZWFkKCkKICAgICAgICBvdHcgPSByZXF1ZXN0cy5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzP2FjY2Vzc190b2tlbj0lcyclKGl0LHRva2V0KSkKICAgICAgICBhID0ganNvbi5sb2FkcyhvdHcudGV4dCkKICAgICAgICBwcmludCAoIlvigKJdIE5hbWUgOiAlcyIlKGFbJ25hbWUnXSkpCiAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgamFsYW4oIlxuWyFdIFRva2VuIEludmFsaWQiKQogICAgICAgIGxvZ2luKCkKICAgIGV4Y2VwdCBJT0Vycm9yOgogICAgICAgIGphbGFuKCJcblshXSBUb2tlbiBJbnZhbGlkIikKICAgICAgICBsb2dpbigpCiAgICB0YW1wdW5nPVtdCiAgICB0ZW1hbj1bXQogICAgbGltID0gaW5wdXQoIlvigKJdIExpbWl0IER1bXAgOiAiKQogICAgcHJpbnQgKCJcbiIpCiAgICBhZGEgPSByZXF1ZXN0cy5nZXQoJ2h0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL3N1YnNjcmliZXJzP2xpbWl0PSVzJmFjY2Vzc190b2tlbj0lcyclKGl0LGxpbSx0b2tldCkpCiAgICBpZGkgPSBqc29uLmxvYWRzKGFkYS50ZXh0KQogICAgZm9yIHggaW4gaWRpWydkYXRhJ106CiAgICAgICAgdGFtcHVuZy5hcHBlbmQoeFsnaWQnXSkKICAgIGZvciBpZCBpbiB0YW1wdW5nOgogICAgICAgIHRyeToKICAgICAgICAgICAgYWRhMiA9IHJlcXVlc3RzLmdldCgnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXMvZnJpZW5kcz9hY2Nlc3NfdG9rZW49JXMnJShpZCx0b2tldCkpCiAgICAgICAgICAgIGlkaTIgPSBqc29uLmxvYWRzKGFkYTIudGV4dCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZm9yIGIgaW4gaWRpMlsnZGF0YSddOgogICAgICAgICAgICAgICAgICAgIHRlbWFuLmFwcGVuZChiWydpZCddKQogICAgICAgICAgICBleGNlcHQgS2V5RXJyb3I6CiAgICAgICAgICAgIAlwcmludCgiWyFdIFByaXZhdGUiKQogICAgICAgICAgICBwcmludCgiW+KAol0iLCBpZCwi4oCiIixsZW4odGVtYW4pKQogICAgICAgICAgICB0ZW1hbi5jbGVhcigpCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBwcmludCgiWyFdIEFrdW4gVGVya2VuYSBTcGFtIikKICAgIGtlbWJhbGkoKQoKZGVmIGtlbWJhbGkoKToKICAgIGlucHV0KCJcblsgS2VtYmFsaSBdIikKICAgIG1lbnUoKQoKaWYgX19uYW1lX189PSJfX21haW5fXyI6CgltZW51KCkK"))